<form name="form" novalidate>
    {% csrf_token %}
    <div id="top-form-wrapper"class="form-inline">
        <div class="form-group" ng-class="{'has-error': form.name.$invalid && !form.name.$pristine}">
            <div class="col-sm-10">
               <label for="name" class="control-label">Name</label>
                <input class="form-control"
                       type="text"
                       name="name"
                       value="{{ choropleth.name }}"
                       ng-maxlength="96"
                       ng-model="choropleth.name"
                       required>
           </div>
       </div>
        <div class="form-group" ng-class="{'has-error': form.published.$invalid && !form.published.$pristine}">
           <div class="col-sm-10">
               <label for="published" class="control-label">Published</label>
               <select class="form-control"
                       name="published"
                       ng-model="choropleth.published">
                       <option value="0">No</option>
                       <option value="1">Yes</option>
               </select>
           </div>
       </div>
       <div class="form-group pull-right">
           <div  id="submission-btns">

               {% if not create %}

                    <button class="btn btn-default btn-sm" data-toggle="modal" data-target="#delete-choropleth-form" >
                        <span class="glyphicon glyphicon-remove"></span>&nbsp;Delete
                    </button>

                {% endif %}

                <button class="btn btn-default btn-sm" ng-click="submit()" ng-disabled="!form.$valid">
                    <span class="glyphicon glyphicon-save"></span>&nbsp;Save
                </button>
            </div>
        </div>
    </div>

    {% include  'partials/choropleth.html' %}


    <section class="row">
        <div class="panel panel-default">
            <div class="panel-heading">
                <a data-toggle="collapse" data-target="#control-body"><span class="glyphicon glyphicon-cog"></span>&nbsp;Map Controls</a>
            </div>
            <div id="control-body" class="panel-body text-center collapse">

                {# Range Select #}
                <div class="form-group col-xs-4" ng-class="{'has-error': form.range.$invalid && !form.range.$pristine}">
                    <label for="range" class="control-label">Range</label>
                    <select class="form-control"
                        name="range"
                        ng-model="choropleth.data_classes"
                        ng-options="n for n in rangeOptions"
                        required>
                    </select>
                </div>

                {# Scheme Select #}
                <div class="form-group col-xs-4">
                    <label for="scheme" class="control-label">Scheme</label>
                    <select class="form-control"
                        name="scheme"
                        ng-model="choropleth.scheme"
                        ng-change="getSchemePalettes(choropleth.scheme)"
                        ng-options="scheme.id as scheme.name for scheme in schemes"
                        required>
                    </select>
                </div>

                {# Palette Select #}
                <div class="form-group col-xs-4">
                    <label for="palette" class="control-label">Palette</label>
                    <select class="form-control"
                        name="palette"
                        ng-model="choropleth.palette"
                        ng-change="findPalette(choropleth.palette)"
                        ng-options="palette.id as palette.name for palette in palettes"
                        required>
                    </select>
                </div>
            <div>
        </div>
    </section>

    {# Mardown description  #}
    <ul class="nav nav-tabs" role="tablist">
        <li ng-class="{active: tab == 1}">
            <a ng-click="tab = 1" href="#description">Description</a>
        </li>
        <li ng-class="{active: tab == 2}">
            <a ng-click="tab = 2" href="#description">Preview</a>
        </li>
        <li ng-class="{active: tab == 3}">
            <a ng-click="tab = 3" href="#description">Cheatsheet</a>
        </li>
    </ul>
    <div id="md" class="tab-member" ng-show="tab == 2">
        <markdown description="choropleth.description"></markdown>
    </div>
    <div class="form-group tab-member" ng-show="tab == 1">
        <textarea class="form-control choropleth-description"
                  name="description"
                  value="{{ choropleth.value }}"
                  ng-model="choropleth.description">
        </textarea>
    </div>
    <div class="tab-member" ng-show="tab == 3">
        <markdown>
            {% include 'partials/markdown-cheatsheet.md' %}
        </markdown>
    </div>
</form>
